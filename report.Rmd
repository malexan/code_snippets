Отношение псковичей к охране архитектурных памятников
========================================================

Александр Матрунич, Институт регионального развития   

`r format(Sys.time(), "%d.%m.%Y %H:%M")`


```{r load, echo=F}
library(foreign)
library(plyr)
library(ggplot2)
library(reshape2)
library(stringr)
# library(corrgram)
library(scales)

suppressMessages(suppressWarnings(data <- read.spss('/home/sas/1irr/data/monuments_jun2013.sav', to.data.frame=T, reencode=T)))
suppressWarnings(labels <- attr(data, 'variable.labels'))

data$v1 <- factor(data$v1, labels=c("нет проблемы", "меня не касается", "острая проблема", "готов лично\nзащищать"))
data$v2 <- factor(data$v2, labels=c("портят облик", "нет ущерба", "украшают город"))
data$v3 <- factor(data$v3, labels=c("пусть строят", "пусть разбираются\nорганы", "подпишу письмо", "встану перед\nбульдозером"))

data$edu <- factor(data$v7, levels=c(levels(data$v7), "высшее"))
data$edu[data$edu %in% c("высшее гуманитарное", "высшее техническое")] <- "высшее"
data$edu <- droplevels(data$edu)
```

```{r setup, echo=F}
options(device = function(file, width=7, height=6, ...) {
  cairo_pdf(tempfile(), width=width, height=height, ...)
  })
```

```{r setup_png, echo=F}
options(device = 'png')
```

# Цели и задачи исследования

Цель исследования - определить, как в общественном мнении Пскова сформировать более критическое отношение к защите памятников архитектуры. Задачи исследования следующие:

1. Определить текущие тенденции в оценках псковичами проблемы охраны памятников.
2. Выделить сегменты псковичей, обладающих различающимися оценками проблемы.
1. Выявить такие характеристики сегментов, которые позволят организовать целенаправленную работу с ними.

Опрошено респондентов методом уличного личного интервью: `r dim(data)[1]`.

Важность охраны памятников архитектуры
-------------
```{r v1_bar, echo=F, fig.width=6, fig.height=5}
f <- ggplot(data[!is.na(data$v1),], aes(v1)) + geom_bar()
f <- f + labs(x='Насколько важна проблема охраны архитектурных памятников', y='Количество респондентов',
          title='Для большинства респондентов\nохрана памятников важна')
f
```
Не являются значимыми различия в оценке важности проблемы между респондентами разного пола: значимость критерия Хи-квадрат составляет `r percent(chisq.test(data$v1, data$sex)$p.value)`, значимость U-критерия Манна-Уитни -  `r percent(wilcox.test(as.numeric(data$v1)~data$sex)$p.value)`, что в обоих случаях выше пороговых 5%.

Значимость влияния уровня образования на оценку значимости проблемы невозможно оценить с помощью критерия Хи-квадрат, так как в одной из ячеек таблицы сопряжённости меньше 5 значений. При разделении респондентов по уровню образования на две группы (высшее - невысшее) значимость различия подтверждается U-критерием Манна-Уитни - `r percent(wilcox.test(as.numeric(data$v1)~(data$edu=="высшее"))$p.value)`.

```{r v1_edu, fig.width=7, fig.height=6, echo=F, dev='png'}
t <- as.data.frame(prop.table(table(data$v1, data$edu=="высшее"), margin=2))
f <- ggplot(t, aes(fill=Var1, x=Var2, y=Freq)) + geom_bar(stat='identity')
f <- f + labs(x="Образование", y="Доля респондентов", title="Обеспокоенных проблемой\nбольше в группе с высшим образованием")
f <- f + scale_fill_brewer(name="Значимость проблемы\nохраны архитектуры")
f <- f + scale_x_discrete(labels=c('высшее', "невысшее")) + scale_y_continuous(labels=percent)
f                  
```

```{r v1_age, fig.width=7, fig.height=6, echo=F, dev='png'}
f <- ggplot(data[!is.na(data$age) & !is.na(data$v1),], aes(age, as.numeric(v1))) + geom_boxplot()
f <- f + labs(x="Возрастная категория респондента", y="Важность проблемы охраны памятников", title="Респонденты старше 45 лет\nчаще обеспокоены охраной памятников")
f <- f + scale_y_continuous(breaks=1:4, labels=levels(data$v1))
f
```
График демонстрирует, что респонденты до 45 лет отличаются от респондентов старше 45 лет. Ответы респондентов младших возрастных групп более равномерно распределены среди категорий оценки важности проблемы охраны архитектурных памятников. А значительное большинство респондентов от 45 лет и старше концентрируется в категории "Острая проблема".

Критерий U подтверждает наличие различий между группами младше и от 45 лет: его значимость составляет `r percent(wilcox.test(as.numeric(data$v1)~as.numeric(data$age)>3)$p.value)`.

```{r v1_age_bars, fig.width=7, fig.height=6, echo=F, dev='png'}
t <- as.data.frame(prop.table(table(data$v1, data$age), margin=2))
f <- ggplot(t, aes(fill=Var1, x=Var2, y=Freq)) + geom_bar(stat='identity')
f <- f + labs(x="Возрастная категория респондента", y="Доля респондентов", title="С увеличением возраста увеличивается\nвероятность обеспокоенности проблемой")
f <- f + scale_fill_brewer(name="Значимость проблемы\nохраны архитектуры")
f <- f + scale_x_discrete(labels=c('18-24', '25-34', '35-44', '45-54', '55-64', '65+')) + scale_y_continuous(labels=percent)
f
```
Наибольшая доля тех, кто готов лично защищать памятники, приходится на категорию 45-54 года. Наибольшая доля считающих, что проблема охраны архитектуры является острой, приходится на пенсионеров. Наибольшая доля тех, кто считает, что подобной проблемы не существует, приходится на молодёжь до 24 лет.


Нарушения высотности зданий при строительстве
-----------------------------------
```{r v2_bar, echo=F, fig.width=6, fig.height=5}
f <- ggplot(data[!is.na(data$v2),], aes(v2, fill=v2=="портят облик")) + geom_bar()
f <- f + labs(x='Ущерб городу от нарушения высотности', y='Количество респондентов',
          title='Большинство респондентов\nне видят проблем в нарушении высотности')
f <- f + guides(fill=F)
f
```

Более трети опрошенных (37% по выборке; от 32% до 42% при переносе на генеральную совокупность) считают, что новые дома, построенные с нарушениями высотности, портят облик города. 

При этом более половины респондентов, считающих, что охрана памятников - это острая проблема, не сказали, что такие дома несут вред городу. Т.е. они не считают, что требования по высотности новых домов обоснованы.

```{r v1_v2_edu_jitter, fig.width=7, fig.height=6, echo=F, dev='png'}

f <- ggplot(data[!is.na(data$v1) & !is.na(data$v2),], aes(v1, v2, color=edu=="высшее")) + 
geom_jitter(na.rm=TRUE)
f <- f + xlab('Важность охраны архпамятников')
f <- f + ylab('Ущерб от нарушения высотности новых домов')
f
```


```{r v1_v2_v5_jitter, fig.width=7, fig.height=6, echo=F, dev='png'}
f <- ggplot(data[!is.na(data$v1) & !is.na(data$v2),], aes(v1, v2, color=v5)) + 
geom_jitter(na.rm=TRUE)
f <- f + xlab('Важность охраны архпамятников')
f <- f + ylab('Ущерб от нарушения высотности новых домов')
f <- f + scale_color_discrete(labels=c("строительству", "истории"), name="Чему\nприоритет?")
f <- f +theme(legend.position="top")
f
```


### Гипотетическое строительство на территории Кремля

```{r v3_bar, echo=F, fig.width=6, fig.height=5}
f <- ggplot(data[!is.na(data$v3),], aes(v3, fill=as.numeric(v3)>2)) + geom_bar()
f <- f + labs(x='Что делать при строительстве в Кремле?', y='Количество респондентов',
          title='Большинство респондентов\nпротив строительства в Кремле')
f <- f + guides(fill=F)
f
```

Две трети опрошенных (67% по выборке, 62%..71% при переносе на генеральную совокупность) против гипотетического строительства новых зданий на территории псковского Кремля. 4 респондента выбрали вариант ответа "Пусть строят". При переносе на генеральную совокупность (население Пскова старше 16 лет - 170 тысяч человек) их количество варьирует в интервале `r x <- prop.test(4, 401)$conf.int; percent(x[1])`..`r percent(x[2])`, т.е. от `r x <- round(170*10^3 * x); x[1]` до `r x[2]` жителей. В дальнейшем мы исключим этих респондентов из анализа.



### Что важнее: жилищное строительство или сохраниние исторического облика




```{r v3_v2_v5_jitter, fig.width=7, fig.height=6, echo=F, dev='png'}
f <- ggplot(data[!is.na(data$v3) & !is.na(data$v2),], aes(v3, v2, color=v5)) + 
geom_jitter(na.rm=TRUE)
f <- f + xlab('Строительство на территории Кремля')
f <- f + ylab('Ущерб от нарушения высотности новых домов')
f <- f + scale_color_discrete(labels=c("строительству", "истории"), name="Чему\nприоритет?")
f <- f +theme(legend.position="top")
x <- data.frame(xmax=4.5, xmin=3.5, ymax=c(3.5, 2.4), ymin=c(2.5, .5))
f <- f + geom_rect(data=x, aes(xmax=xmax, xmin=xmin, ymax=ymax, ymin=ymin), color='grey20', alpha=.1, inherit.aes=F)
f
```

```{r v3_v2__v1_v5_jitter, fig.width=7, fig.height=6, echo=F, dev='png'}
f <- ggplot(data[!is.na(data$v3) & !is.na(data$v2),], aes(v3, v2, color=v1, shape=v5)) + 
geom_jitter(na.rm=TRUE)
f <- f + xlab('Строительство на территории Кремля')
f <- f + ylab('Ущерб от нарушения высотности новых домов')
f <- f + scale_color_brewer(name="Проблема охраны\nпамятников")
f <- f + scale_shape_discrete(labels=c("строительству", "истории"), name="Чему\nприоритет?")
f
```
